<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tabulkový editor: ÚVODNÍ STRÁNKA</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tabulkový editor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ÚVODNÍ STRÁNKA </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> </p>
<h2><a class="anchor" id="autotoc_md1"></a>
Tabulkový editor:</h2>
<ul>
<li>čtvercová tabulka složená z buněk</li>
<li>buňka obsahuje hodnotu nebo výraz</li>
<li>buňku lze použít ve výrazu jiné buňky</li>
<li>v případě vzorce:<ul>
<li>buňka aktualizuje svou hodnotu na základě vzorce</li>
<li>výraz s cyklem je zakázaný</li>
<li>syntakticky nesprávný výraz je zakázaný</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Funkcionality:</h2>
<ul>
<li>čísla: sčítání, odčítání, násobení, dělení</li>
<li>řetězce: spojení, opakování</li>
<li>3 jednoduché funkce: ABS, UPPER, LOWER</li>
<li>základní operace se mohou vnořovat pomocí závorek</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Práce s tabulkou:</h2>
<ul>
<li>obnovení tabulky ze souboru (včetně vzorců)</li>
<li>uložit tabulku do souboru v čitelné podobě</li>
<li>vypsat tabulku s hodnotami nebo vzorci do terminálu</li>
<li>v případě, že je v buňce výraz se špatnými operandy, vypíše se do buňky "#ERROR"</li>
<li>v případě, že buňka obsahuje výraz obsahující prázdnou buňku, bude při výpisu hodnot tato buňka také prázdná</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
PRÁCE PROGRAMU</h1>
<h3><a class="anchor" id="autotoc_md5"></a>
NAČTENÍ KONFIGURACE (implicitně):</h3>
<ul>
<li>velikost nové tabulky</li>
<li>znak oddělení řádků</li>
<li>znak oddělení sloupců</li>
<li>zdroj příkazů</li>
<li>cíl výstupu</li>
</ul>
<h3><a class="anchor" id="autotoc_md6"></a>
VÝBĚR Z MOŽNOSTÍ NAČTENÍ TABULKY</h3>
<ul>
<li>1, načtení existující - výzva na jméno souboru - načtení</li>
<li>2, vytvoření nové</li>
</ul>
<h3><a class="anchor" id="autotoc_md7"></a>
UPRAVOVÁNÍ TABULKY:</h3>
<ul>
<li>vstup od uživatele dokud uživatel nezavolá "quit"<ul>
<li>po příkazu "quit" - dialog s možností uložení tabulky do souboru a případnou výzvu o název souboru</li>
</ul>
</li>
<li>PŘÍKAZY:<ul>
<li><p class="startli">přiřadit buňce výraz s vnořenými výrazy pomocí závorek:</p><ul>
<li>XX = ...</li>
</ul>
<p class="startli">operandy:</p><ul>
<li>číslo .. 15 (samostatné číslice)</li>
<li>text .. "ahoj" (znaky ohraničené znakem '"')</li>
<li>buňka .. E7 (název buňky)<ul>
<li>sloupce pojmenovány A - Z, AA - AZ, BA - BZ, ...</li>
<li>řádky očíslovány od 1</li>
</ul>
</li>
</ul>
<p class="startli">operátory:</p><ul>
<li>číslo + číslo (sčítání čísel)</li>
<li>číslo - číslo (odečítání čísel)</li>
<li>číslo * číslo (násobení čísel)</li>
<li>číslo / číslo (dělení čísel)</li>
<li>text CONCAT text (konkatenace řetězců)</li>
<li>text REPEAT číslo (opakování řetězce)</li>
</ul>
<p class="startli">funkce:</p><ul>
<li>ABS číslo (absolutní hodnota)</li>
<li>UPPER text .. (převod písmenných znaků řetězce na uppercase)</li>
<li>LOWER text .. (převod písmenných znaků řetězce na lowercase)</li>
</ul>
</li>
<li>vymazat obsah buňky<ul>
<li>samotná buňka: delete XX</li>
<li>rozsah buněk: delete XX : XX</li>
<li>celá tabulka: delete</li>
</ul>
</li>
<li>výpis tabulky:<ul>
<li>pouze vzorce: printf</li>
<li>vyhodnocené buňky: print<ul>
<li>samotná buňka: print(f) XX</li>
<li>rozsah buněk: print(f) XX : XX</li>
<li>celá tabulka: print(f)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md8"></a>
POLYMORFIZMUS</h1>
<ul>
<li>Výraz, který je přiřazený buňce bude reprezentovaný stromem, kde uzly budou potomci abstraktního datového typu (<a class="el" href="classCExpression.html" title="Abstract class representing node in a tree representing expression in a cell.">CExpression</a>), který umožní zachytit složený výraz a prioritu operátorů.</li>
<li>Společným rozhraním tohoto abstraktního datového typu bude metoda Evaluate, která vrátí výslednou hodnotu daného uzlu (<a class="el" href="structCValue.html" title="Wrapper around variant representing constant value in table.">CValue</a>).</li>
<li>Polymorfizmus spočívá v tom, že tato metoda Evaluate bude volána nad každým uzlem, kterým můžou být různí potomci (operátory, konstanty, odkazy na buňky,...).</li>
<li>Např. operátor plus zavolá Evaluate() na své dva operandy a následně je sečte a výsledek pošle volajícímu.</li>
<li>Nebo samotný list (CExprValue) stromu výrazu, který vrátí přímo hodnotu (<a class="el" href="structCValue.html" title="Wrapper around variant representing constant value in table.">CValue</a>), kterou má v sobě uloženou.</li>
<li>Dalším příkladem polymorfismu je metoda SetOperands u třídy <a class="el" href="classCOperator.html" title="Abstract class representing operator in expression tree.">COperator</a>.</li>
<li>Potomky jsou unární a binární operátory, které mají vlastní implementaci této metody, přitom se při zpracování výrazu volají polymorfně.</li>
<li>Dále je polymorfismus uplatněn také ve funktoru <a class="el" href="classCPrint.html" title="Class providing printing of table range.">CPrint</a>, který tvoří společné rozhraní pro potomky <a class="el" href="classCPrintValue.html" title="Class prividing printing of cell values in given table range.">CPrintValue</a> a <a class="el" href="classCPrintFormula.html" title="Class prividing printing of cell formulas in given table range.">CPrintFormula</a>.</li>
<li>Tam se volá polymorfní metoda GetContent, vracející buď řetězec reprezentující vzorec uložený do buňky (třída <a class="el" href="classCPrintFormula.html" title="Class prividing printing of cell formulas in given table range.">CPrintFormula</a>), nebo výslednou hodnotu buňky (třída <a class="el" href="classCPrintValue.html" title="Class prividing printing of cell values in given table range.">CPrintValue</a>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md9"></a>
ALGORITMY</h2>
<h4><a class="anchor" id="autotoc_md10"></a>
Zpracování složených výrazů se závorkami</h4>
<ul>
<li>Výrazy jsou zpracovány ShuntingYard algoritmem.</li>
<li>Funkce a operátory krát a děleno mají nejvyšší prioritu, operátory plus, minus a konkatenace a opakování řetězce mají nižší.</li>
<li>Nejnižší prioritu mají v mé implementace závorky z toho důvodu, že se vždycky levá závorka posílá na zásobník operátorů a chceme výrazy uvnitř závorky začít vyzvedávat až po čtení pravé závorky.</li>
</ul>
<h4><a class="anchor" id="autotoc_md11"></a>
Ošetření cyklů ve výrazech:</h4>
<ul>
<li>Při čtení výrazu se ukládá k buňce informace, na kterých buňkách je závislá</li>
<li>Po zpracování výrazu se z aktuálně upravované buňky pošleme DFS a pokud dorazíme na tu samou buňku, nalezli jsme cyklus a tento výraz nedovolíme uložit</li>
</ul>
<h4><a class="anchor" id="autotoc_md12"></a>
Vyhodnocení hodnoty buněk (před výpisem tabulky):</h4>
<ul>
<li>Pomocí TopSort algoritmu se určí pořadí buněk, ve kterém se mají vyhodnotit tak, aby měla každá buňka zaručené, že buňky, na kterých je závislá, budou vyhodnocené</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
Ukázka</h2>
<div class="fragment"><div class="line">Do you want to load existing table?</div>
<div class="line">&gt; yes</div>
<div class="line">Enter file name: </div>
<div class="line">&gt; examples/basic.save</div>
<div class="line">Edit table:</div>
<div class="line">&gt;&gt; printf</div>
<div class="line">  | A               | B                                    | C                                          | D               | E                   | </div>
<div class="line">-------------------------------------------------------------------------------------------------------------------------------------------------</div>
<div class="line">1 |  = 50           |  = &quot;text&quot;                            |  = &quot;ahoj &quot; REPEAT ( ( 13 + A1 - 53 ) / 5 ) |  = B1 CONCAT E1 |  = C1 CONCAT &quot;text&quot; | </div>
<div class="line">-------------------------------------------------------------------------------------------------------------------------------------------------</div>
<div class="line">2 |  = B1 CONCAT C1 |  = A1 * ( ( 20 + 30 ) / 5 - 3 ) / 35 |  = A1 + D2                                 |  = -40          |                     | </div>
<div class="line">-------------------------------------------------------------------------------------------------------------------------------------------------</div>
<div class="line">3 |                 |                                      |                                            |                 |                     | </div>
<div class="line">-------------------------------------------------------------------------------------------------------------------------------------------------</div>
<div class="line">4 |  = B1           |                                      |                                            |                 |                     | </div>
<div class="line">-------------------------------------------------------------------------------------------------------------------------------------------------</div>
<div class="line">5 |                 |                                      |                                            |                 |                     | </div>
<div class="line">-------------------------------------------------------------------------------------------------------------------------------------------------</div>
<div class="line">&gt;&gt; print </div>
<div class="line">  | A              | B    | C          | D                  | E              | </div>
<div class="line">------------------------------------------------------------------------------</div>
<div class="line">1 | 50             | text | ahoj ahoj  | textahoj ahoj text | ahoj ahoj text | </div>
<div class="line">------------------------------------------------------------------------------</div>
<div class="line">2 | textahoj ahoj  | 10   | 10         | -40                |                | </div>
<div class="line">------------------------------------------------------------------------------</div>
<div class="line">3 |                |      |            |                    |                | </div>
<div class="line">------------------------------------------------------------------------------</div>
<div class="line">4 | text           |      |            |                    |                | </div>
<div class="line">------------------------------------------------------------------------------</div>
<div class="line">5 |                |      |            |                    |                | </div>
<div class="line">------------------------------------------------------------------------------</div>
<div class="line">&gt;&gt; delete A2 : C2</div>
<div class="line">&gt;&gt; printf</div>
<div class="line">  | A     | B         | C                                          | D               | E                   | </div>
<div class="line">------------------------------------------------------------------------------------------------------------</div>
<div class="line">1 |  = 50 |  = &quot;text&quot; |  = &quot;ahoj &quot; REPEAT ( ( 13 + A1 - 53 ) / 5 ) |  = B1 CONCAT E1 |  = C1 CONCAT &quot;text&quot; | </div>
<div class="line">------------------------------------------------------------------------------------------------------------</div>
<div class="line">2 |       |           |                                            |  = -40          |                     | </div>
<div class="line">------------------------------------------------------------------------------------------------------------</div>
<div class="line">3 |       |           |                                            |                 |                     | </div>
<div class="line">------------------------------------------------------------------------------------------------------------</div>
<div class="line">4 |  = B1 |           |                                            |                 |                     | </div>
<div class="line">------------------------------------------------------------------------------------------------------------</div>
<div class="line">5 |       |           |                                            |                 |                     | </div>
<div class="line">------------------------------------------------------------------------------------------------------------</div>
<div class="line">&gt;&gt; A2 = A1 / ( A1 + D2 )</div>
<div class="line">&gt;&gt; print</div>
<div class="line">  | A    | B    | C          | D                  | E              | </div>
<div class="line">--------------------------------------------------------------------</div>
<div class="line">1 | 50   | text | ahoj ahoj  | textahoj ahoj text | ahoj ahoj text | </div>
<div class="line">--------------------------------------------------------------------</div>
<div class="line">2 | 5    |      |            | -40                |                | </div>
<div class="line">--------------------------------------------------------------------</div>
<div class="line">3 |      |      |            |                    |                | </div>
<div class="line">--------------------------------------------------------------------</div>
<div class="line">4 | text |      |            |                    |                | </div>
<div class="line">--------------------------------------------------------------------</div>
<div class="line">5 |      |      |            |                    |                | </div>
<div class="line">--------------------------------------------------------------------</div>
<div class="line">&gt;&gt; quit</div>
<div class="line">Do you want to save table?</div>
<div class="line">&gt; yes</div>
<div class="line">Enter file name: </div>
<div class="line">&gt; table.save</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
